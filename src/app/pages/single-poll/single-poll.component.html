<div class="min-h-screen bg-gray-900 text-white p-6 pt-24">
  <div class="max-w-2xl mx-auto">

    <!-- Loader -->
    <div *ngIf="loading" class="flex justify-center items-center my-10">
      <div class="animate-spin h-10 w-10 border-4 border-cyan-400 border-t-transparent rounded-full"></div>
    </div>

    <!-- Error -->
    <div *ngIf="!loading && errorMessage" class="bg-red-600 p-4 rounded mb-6 text-white text-center">
      {{ errorMessage }}
    </div>

    <!-- Invalid / Missing Poll
    <div *ngIf="!loading && !selectedPoll && !errorMessage" class="text-center text-gray-300">
      Poll not found.
    </div> -->

    <!-- Poll Content -->
    <div *ngIf="!loading && selectedPoll" class="bg-gray-800 p-6 rounded-lg shadow-lg space-y-6">

      <!-- Title + Description -->
      <div>
        <h2 class="text-2xl font-bold text-cyan-400">{{ selectedPoll.title }}</h2>
        <p class="text-gray-400 italic">{{ selectedPoll.description }}</p>
        <p class="mt-2 text-lg">{{ selectedPoll.question }}</p>
      </div>

      <!-- Status / Vote Info -->
      <div class="space-y-2">
        <div *ngIf="!selectedPoll.isActive" class="text-yellow-400 bg-yellow-900 p-3 rounded text-center">
          The poll has ended.
        </div>

        <div *ngIf="selectedPoll.isActive && selectedPoll.realtime" class="text-green-400 bg-green-900 p-3 rounded text-center">
          Realtime results enabled.
        </div>

        <div *ngIf="selectedPoll.isActive && !selectedPoll.realtime" class="text-blue-300 bg-blue-900 p-3 rounded text-center">
          Results will be available on: <strong>{{ selectedPoll.deadline | date:'medium' }}</strong>
        </div>
      </div>

      <!-- Voting Options -->
      <div *ngIf="selectedPoll.isActive && !hasVoted">
        <h3 class="text-lg font-semibold text-cyan-300">Choose an answer:</h3>
        <form class="space-y-3">
          <label *ngFor="let answer of selectedPoll.answers; let i = index"
                 class="block bg-gray-700 p-3 rounded cursor-pointer hover:bg-gray-600">
            <input type="radio" [value]="answer" name="answer" class="mr-2 accent-cyan-500"
                   [(ngModel)]="selectedAnswer" />
            {{ answer }}
          </label>
        </form>
        <button (click)="submitVote()" 
                [disabled]="!selectedAnswer || loading"
                class="mt-4 w-full bg-cyan-500 hover:bg-cyan-600 text-white font-semibold py-3 px-6 rounded shadow transition">
          Submit Vote
        </button>
      </div>

      <!-- Already Voted Message -->
      <div *ngIf="hasVoted && selectedPoll.isActive && !selectedPoll.realtime" class="text-yellow-300 bg-yellow-900 p-3 rounded text-center">
        You already voted. Results will be available on: <strong>{{ selectedPoll.deadline | date:'medium' }}</strong>
      </div>

      <!-- Results -->
      <div *ngIf="!selectedPoll.isActive || (hasVoted && selectedPoll.realtime)" class="pt-4">
        <h3 class="text-lg font-semibold text-cyan-300 mb-3">Results</h3>

        <div *ngFor="let answer of selectedPoll.answers; let i = index" class="mb-4">
          <div class="flex justify-between text-sm mb-1">
            <span>{{ answer }}</span>
            <span>{{ selectedPoll.results[i] || '0' }} votes</span>
          </div>
          <div class="w-full bg-gray-700 h-3 rounded overflow-hidden">
            <!-- <div class="bg-cyan-500 h-full transition-all duration-300"
                 {{ (totalVotes() > 0) ? (+selectedPoll.results[i] / totalVotes() * 100) | number:'1.1-1' : 0 }}%></div>
          </div> -->
        </div>

        <p class="text-sm text-gray-300 mt-2">Total votes: {{ totalVotes() }}</p>
      </div>

    </div>
  </div>
</div>

